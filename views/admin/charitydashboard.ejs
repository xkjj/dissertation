<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Charity Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css">
</head>
<body>

<div class="container mt-2 py-4 mb-4 bg-dark rounded-3 text-white">
    <div class="p-4">
        <h2 class="fw-bolder display-5">Charity Dashboard</h2>
        <p class="lead">Manage items and requests for your charity</p>
        <a href="/homepage" class="btn btn-dark mt-3">Homepage</a>
    </div>
</div>

<div class="container">

    <!-- Clothing Items Section -->
    <h4 class="mb-3">Clothing Items</h4>

    <% if (items.length === 0) { %>
        <p>No items assigned to this charity.</p>
    <% } %>

    <div class="row mb-5">
        <% items.forEach(item => { %>
            <div class="col-md-4 mb-3">
                <div class="card h-100">
                    <div class="card-body">
                        <h5><%= item.title %></h5>
                        <p><%= item.description %></p>
                        <span class="badge bg-secondary">
                            Status: <%= item.status %>
                        </span>
                    </div>
                </div>
            </div>
        <% }) %>
    </div>

    <!-- Requests Section -->
    <h4 class="mb-3">Item Requests</h4>

    <% if (requests.length === 0) { %>
        <p>No requests submitted yet.</p>
    <% } %>

    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Item</th>
                <th>Requested By</th>
                <th>Status</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            <% requests.forEach(request => { %>
                <tr>
                    <td><%= request.title %></td>
                    <td><%= request.requester %></td>
                    <td>
                        <% if (request.status === 'pending') { %>

                            <span class="badge bg-warning text-dark">Pending</span>

                            <div class="mt-2">

                                <form action="/admin/charitydashboard/<%= request.request_id %>/approve"
                                    method="POST"
                                    class="d-inline">
                                    <button class="btn btn-sm btn-success">
                                        Approve
                                    </button>
                                </form>

                                <form action="/admin/charitydashboard/<%= request.request_id %>/reject"
                                    method="POST"
                                    class="d-inline ms-2">
                                    <button class="btn btn-sm btn-danger">
                                        Reject
                                    </button>
                                </form>

                            </div>

                        <% } else if (request.status === 'approved') { %>

                            <span class="badge bg-success">Approved</span>

                        <% } else { %>

                            <span class="badge bg-danger">Rejected</span>

                        <% } %>
                    </td>
                    <td><%= request.requested_at %></td>
                </tr>
            <% }) %>
        </tbody>
    </table>

</div>
</body>
</html>
